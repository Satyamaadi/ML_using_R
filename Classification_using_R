
$`849`
[1] "hey gal anyon u go e drive centr tmr"

$`850`
[1] "remind hrs"

$`851`
[1] "know can pls open back"

$`852`
[1] "will guy close"

$`853`
[1] "cool breez bright sun fresh flower twitter bird wait wish u goodmorn nice day"

$`854`
[1] "thank rington order ref number k mobil will charg £ tone arriv pleas call custom servic"

$`855`
[1] "uncl abbey happi new year abiola"

$`856`
[1] "ok wont call disturb one know avoid burden"

$`857`
[1] "custom place will call"

$`858`
[1] "boy late home father power frndship"

$`859`
[1] "good morn dear shijutta great success day"

$`860`
[1] "okay chase dream good next"

$`861`
[1] "en chikku nang bakra msg kalstiya teacoffe"

$`862`
[1] "ur pin"

$`863`
[1] "hi ur lookin sauci daytim fun wiv busti marri woman free next week chat now sort time janinexx calls£minmobsmorelkpoboxhpfl"

$`864`
[1] "k call close"

$`865`
[1] "good morn princess great day"

$`866`
[1] "dude like buff wind"

$`867`
[1] "todaysundaysunday holiday work"

$`868`
[1] "u gonna get deus ex"

$`869`
[1] "cha quiteamuz ’scool babeprobpop cu satthen hunni brekki love jen xxx psxtra lrg portion pleas"

$`870`
[1] "parent kidz friend n colleagu scream surpris wait sofa nake"

$`871`
[1] "now unsubscrib servic get ton sexi babe hunk straight phone go httpgotbabescouk subscript"

$`872`
[1] "miser tell u side effect birth control massiv gut wrench cramp first month sleep last night"

$`873`
[1] "jane babe goin wrk feel ill lst nite fone alreadi cover chuck"

$`874`
[1] "oh ok wait lect havent finish"

$`875`
[1] "mayb fat finger just press button know"

$`876`
[1] "ok feel like john lennon"

$`877`
[1] "ranjith cal drpd deeraj deepak min hold"

$`878`
[1] "hi mobil ad contact list wwwfullonsmscom s great place send free sms peopl visit fullonsmscom"

$`879`
[1] "loan purpos £ £ homeown tenant welcom previous refus can still help call free text back help"

$`880`
[1] "workin get job"

$`881`
[1] "well keep mind got enough gas one round trip bar sudden influx cash"

$`882`
[1] "sorri earlier put fire around talk actual life lol"

$`883`
[1] "p per min call germani bt line just p per min check planettalkinstantcom info ts cs text stop opt"

$`884`
[1] "custom servic announc recent tri make deliveri unabl pleas call reschedul ref"

$`885`
[1] "can talk"

$`886`
[1] "guess good excus lol"

$`887`
[1] "alright sure let know leav"

$`888`
[1] "ard like dat y"

$`889`
[1] "carlo take sweet time usual let know patti donew smoke tell haul ass"

$`890`
[1] "u can win £ music gift voucher everi week start now txt word draw tscs wwwidewcom skillgam winaweek age ppermesssubscript"

$`891`
[1] "height recycl read twice peopl spend time earn money money spent spend time good morn keep smile"

$`892`
[1] "great new offer doubl min doubl txt best orang tariff get latest camera phone free call mobileupd free now stoptxt tcs"

$`893`
[1] "shant disturb u anymor jia"

$`894`
[1] "alex say ok ok"

$`895`
[1] "dont hesit know second time weak like keep notebook eat day anyth chang day can sure noth"

$`896`
[1] "alreadi back home probabl"

$`897`
[1] "nothin come mind u help buy hanger lor ur laptop heavi"

$`898`
[1] "win winner mr t foley won ipod excit prize soon keep eye ur mobil visit wwwwincouk"

$`899`
[1] "wana plan trip sometm"

$`900`
[1] "rightio well arent bright earli morn"

$`901`
[1] "free top rington sub week ringtoneget st week freesend subpoli per weekstop sms"

$`902`
[1] "k work someth"

$`903`
[1] "gonna way specif"

$`904`
[1] "can pleas send aunti number"

$`905`
[1] "work time"

$`906`
[1] "year mani mile"

$`907`
[1] "know mallika sherawat yesterday find now url"

$`908`
[1] "tire slept well past night"

$`909`
[1] "yeah probabl"

$`910`
[1] "hey pple nightsexcel locat wif breakfast hamper"

$`911`
[1] "ll post lr class"

$`912`
[1] "nooooooo gonna bore death day cabl internet outag"

$`913`
[1] "wat u"

$`914`
[1] "pen thing beyond joke wont biro master ever"

$`915`
[1] "u awak snow"

$`916`
[1] "way stay oh"

$`917`
[1] "still chanc search hard will get let tri"

$`918`
[1] "keep away like"

$`919`
[1] "privat account statement show unredeem s m point call identifi code expir"

$`920`
[1] "yup ok go home look time msg u xuhui go learn nd may lesson"

$`921`
[1] "want send virtual hug need one"

$`922`
[1] "take part mobil survey yesterday can now text use howev wish get txts just send txt tc wwwtxtcom p"

$`923`
[1] "sunshin hol claim ur med holiday send stamp self address envelop drink us uk po box bray wicklow eir quiz start saturday unsub stop"

$`924`
[1] "wanna art d"

$`925`
[1] "goodnight da thangam realli miss u dear"

$`926`
[1] "thank honey great day"

$`927`
[1] "dude avatar d imp one point thought actual fli room almost tri hittng one reflex"

$`928`
[1] "carlo pick swing usf littl bit"

$`929`
[1] "free msg singl find partner area s real peopl wait chat nowsend chat cncl send stopc £ per msg"

$`930`
[1] "aight can text address"

$`931`
[1] "ok lor go tog lor"

$`932`
[1] "sorri went bed earli nightnight"

$`933`
[1] "ur cashbal current pound maxim ur cash now send go pmeg cc hgsuiteland rowwjhl"

$`934`
[1] "bold"

$`935`
[1] "ve won costa del sol holiday £ await collect call now toclaim sae tc s pobox stockport skxh cost£pm maxmin"

$`936`
[1] "gas station go"

$`937`
[1] "ok sure time tho sure can get librari class will tri see point good eve"

$`938`
[1] "pls stop bootydeli f invit friend repli yes see wwwsmsacubootydeli stop send stop frnd"

$`939`
[1] "start send blackberri torch nigeria will find buyer like month tell dad buy bb anyon oh"

$`940`
[1] "got mail panren paru"

$`941`
[1] "dun wear jean lor"

$`942`
[1] "haha heard text around"

$`943`
[1] "sorri go home first daddi come fetch u later"

$`944`
[1] "mmmmmm love much ahmad wait year begin everi second take closer side happi new year love"

$`945`
[1] "way transport less problemat sat night way u want ask n join bday feel free need know definit nos book fri"

$`946`
[1] "lol enjoy role play much"

$`947`
[1] "blank blank wat blank lol"

$`948`
[1] "summer final fanci chat flirt sexi singl yr area get match just repli summer now free join optout txt stop help"

$`949`
[1] "finish liao u"

$`950`
[1] "great hope like man well endow inch"

$`951`
[1] "edison right said fool can ask question wise man can answer now know us speechless viva gmgngegnt"

$`952`
[1] "hui xin da lib"

$`953`
[1] "new textbuddi chat horni guy ur area just p free receiv search postcod gaytextbuddycom txt one name"

$`954`
[1] "yes princess go make moan"

$`955`
[1] "tri someth dear read someth exam"

$`956`
[1] "got ten buck jay noncomitt"

$`957`
[1] "ok ill send decim ok"

$`958`
[1] "hi wlcome back wonder got eaten lion someth noth much"

$`959`
[1] "live simpl love also simpl laugh simpl win tooo simpl simpl difficult gud nte"

$`960`
[1] "yes nigh cant aha"

$`961`
[1] "winner u special select receiv £ cash holiday flight inc speak live oper claim"

$`962`
[1] "happi sad one thing past good morn"

$`963`
[1] "thank subscript rington uk mobil will charg £month pleas confirm repli yes repli will charg"

$`964`
[1] "hey mate spoke mag peopl deliv end month deliv th sept talk later"

$`965`
[1] "hi darlin kate u doin somethin tonight im go pub call swan someth parent one drink phone u can"

$`966`
[1] "will see half hour"

$`967`
[1] "tri call re repli sms video mobil min unlimit text free camcord repli call now del thur"

$`968`
[1] "ok found dis pierr cardin one look normal cost sale"

$`969`
[1] "s fine difficulti phone work mine can pls send anoth friend request"

$`970`
[1] "babe love cover face kiss"

$`971`
[1] "ur sis"

$`972`
[1] "sit ard noth lor u leh busi w work"

$`973`
[1] "get free call"

$`974`
[1] "wont wat wit guy"

$`975`
[1] "noth can"

$`976`
[1] "u got wat buy tell us u need come"

$`977`
[1] "ill littl closer like bus stop street"

$`978`
[1] "u takin linear algebra today"

$`979`
[1] "ya u take ure practic lesson start june"

$`980`
[1] "get ticket walsal tue th march mate get sat ill pay treat want go txt bak terri"

$`981`
[1] "time want come"

$`982`
[1] "sms ac sun post hello seem cool want say hi hi stop send stop"

$`983`
[1] "urgent pleas call landlin complimentari lux costa del sol holiday £ cash await collect ppm sae tcs jame ehrr"

$`984`
[1] "just wait till end march el nino get oh"

$`985`
[1] "aslamalaikkuminsha allah tohar beeen muht albi mufti mahfuuzmean"

$`986`
[1] "r u go send"

$`987`
[1] "apart one told yesterday"

$`988`
[1] "awesom think can get th usf time tonight"

$`989`
[1] "truek u knw dis"

$`990`
[1] "sorri batteri die yeah"

$`991`
[1] "cant pick phone right now pls send messag"

$`992`
[1] "sorri never hear unless book one kinda jokethet realli look skinni white girl one line can much camera someth like cast look"

$`993`
[1] "yes think offic lap room think that last day didnt shut"

$`994`
[1] "armand say get butt epsilon"

$`995`
[1] "depend like treat"

$`996`
[1] "also famili go rhode island wherev leav alon week new bong"

$`997`
[1] "sfine anytim best"

$`998`
[1] "sister got place birla soft da"

$`999`
[1] "yeah fact just ask need anyth like hour ago much"

$`1000`
[1] "kk tomorrow onward start ah"

 [ reached getOption("max.print") -- omitted 4559 entries ]
> sms_dtm <- DocumentTermMatrix(sms_clean)
> sms_dtm
<<DocumentTermMatrix (documents: 5559, terms: 6542)>>
Non-/sparse entries: 42112/36324866
Sparsity           : 100%
Maximal term length: 40
Weighting          : term frequency (tf)
> sms_dtm_train <- sms_dtm[1:4169, ]
> 
> sms_dtm_test  <- sms_dtm[4170:5559, ]
> 
> sms_train_labels <- sms_raw[1:4169, ]$type
Error: object 'sms_raw' not found
> sms_train_labels <- sms_data[1:4169, ]$type
> sms_test_labels <- sms_data[4170:5559, ]$type
> prop.table(table(sms_train_labels))
sms_train_labels
      ham      spam 
0.8647158 0.1352842 
> prop.table(table(sms_test_labels))
sms_test_labels
      ham      spam 
0.8683453 0.1316547 
> library(wordcloud)
Error in library(wordcloud) : there is no package called ‘wordcloud’
> install.packages('wordcloud')
Installing package into ‘/cloud/lib/x86_64-pc-linux-gnu-library/4.2’
(as ‘lib’ is unspecified)
also installing the dependency ‘RColorBrewer’

trying URL 'http://rspm/default/__linux__/focal/latest/src/contrib/RColorBrewer_1.1-3.tar.gz'
Content type 'application/x-gzip' length 53057 bytes (51 KB)
==================================================
downloaded 51 KB

trying URL 'http://rspm/default/__linux__/focal/latest/src/contrib/wordcloud_2.6.tar.gz'
Content type 'application/x-gzip' length 106143 bytes (103 KB)
==================================================
downloaded 103 KB

* installing *binary* package ‘RColorBrewer’ ...
* DONE (RColorBrewer)
* installing *binary* package ‘wordcloud’ ...
* DONE (wordcloud)

The downloaded source packages are in
	‘/tmp/RtmpkFYIbE/downloaded_packages’
> library(wordcloud)
Loading required package: RColorBrewer
> wordcloud(sms_clean,min.freq = 50,random.order = FALSE)
There were 50 or more warnings (use warnings() to see the first 50)
> spam <- subset(sms_raw, type == "spam")
Error in subset(sms_raw, type == "spam") : object 'sms_raw' not found
> spam <- subset(sms_data, type == "spam")
> ham  <- subset(sms_data, type == "ham")
> 
> wordcloud(spam$text, max.words = 40, scale = c(3, 0.5))
Warning messages:
1: In tm_map.SimpleCorpus(corpus, tm::removePunctuation) :
  transformation drops documents
2: In tm_map.SimpleCorpus(corpus, function(x) tm::removeWords(x, tm::stopwords())) :
  transformation drops documents
> wordcloud(ham$text, max.words = 40, scale = c(3, 0.5))
Warning messages:
1: In tm_map.SimpleCorpus(corpus, tm::removePunctuation) :
  transformation drops documents
2: In tm_map.SimpleCorpus(corpus, function(x) tm::removeWords(x, tm::stopwords())) :
  transformation drops documents
> indFreqTerms(sms_dtm_train, 5)
Error in indFreqTerms(sms_dtm_train, 5) : 
  could not find function "indFreqTerms"
> FindFreqTerms(sms_dtm_train, 5)
Error in FindFreqTerms(sms_dtm_train, 5) : 
  could not find function "FindFreqTerms"
> findFreqTerms(sms_dtm_train, 5)
   [1] "£wk"                 "abiola"              "abl"                
   [4] "abt"                 "accept"              "access"             
   [7] "account"             "across"              "act"                
  [10] "activ"               "actual"              "add"                
  [13] "address"             "admir"               "adult"              
  [16] "advanc"              "aft"                 "afternoon"          
  [19] "age"                 "ago"                 "aha"                
  [22] "ahead"               "aight"               "aint"               
  [25] "air"                 "aiyo"                "alex"               
  [28] "almost"              "alon"                "alreadi"            
  [31] "alright"             "also"                "alway"              
  [34] "angri"               "announc"             "anoth"              
  [37] "answer"              "anymor"              "anyon"              
  [40] "anyth"               "anytim"              "anyway"             
  [43] "apart"               "app"                 "appli"              
  [46] "appreci"             "arcad"               "ard"                
  [49] "area"                "argu"                "argument"           
  [52] "armand"              "around"              "arrang"             
  [55] "arriv"               "asap"                "ask"                
  [58] "askd"                "attempt"             "auction"            
  [61] "avail"               "ave"                 "avoid"              
  [64] "await"               "awak"                "award"              
  [67] "away"                "awesom"              "babe"               
  [70] "babi"                "back"                "bad"                
  [73] "bag"                 "bank"                "bare"               
  [76] "basic"               "bath"                "batteri"            
  [79] "bcoz"                "bday"                "beauti"             
  [82] "becom"               "bed"                 "bedroom"            
  [85] "beer"                "begin"               "believ"             
  [88] "best"                "better"              "bid"                
  [91] "big"                 "bill"                "bird"               
  [94] "birthday"            "bit"                 "black"              
  [97] "blank"               "bless"               "blue"               
 [100] "bluetooth"           "bold"                "bonus"              
 [103] "boo"                 "book"                "boost"              
 [106] "bore"                "boss"                "bother"             
 [109] "bout"                "box"                 "boy"                
 [112] "boytoy"              "break"               "breath"             
 [115] "bring"               "brother"             "bslvyl"             
 [118] "btnationalr"         "buck"                "bus"                
 [121] "busi"                "buy"                 "cabin"              
 [124] "call"                "caller"              "callertun"          
 [127] "camcord"             "came"                "camera"             
 [130] "campus"              "can"                 "cancel"             
 [133] "cancer"              "cant"                "car"                
 [136] "card"                "care"                "carlo"              
 [139] "case"                "cash"                "cashbal"            
 [142] "catch"               "caus"                "celebr"             
 [145] "cell"                "centr"               "chanc"              
 [148] "chang"               "charg"               "chat"               
 [151] "cheap"               "cheaper"             "check"              
 [154] "cheer"               "chennai"             "chikku"             
 [157] "childish"            "children"            "choic"              
 [160] "choos"               "christma"            "claim"              
 [163] "class"               "clean"               "clear"              
 [166] "close"               "club"                "code"               
 [169] "coffe"               "cold"                "colleagu"           
 [172] "collect"             "colleg"              "colour"             
 [175] "come"                "comin"               "comp"               
 [178] "compani"             "competit"            "complet"            
 [181] "complimentari"       "comput"              "condit"             
 [184] "confirm"             "congrat"             "congratul"          
 [187] "connect"             "contact"             "content"            
 [190] "contract"            "cook"                "cool"               
 [193] "copi"                "correct"             "cos"                
 [196] "cost"                "cost£pm"             "costa"              
 [199] "coupl"               "cours"               "cover"              
 [202] "coz"                 "crave"               "crazi"              
 [205] "creat"               "credit"              "cri"                
 [208] "cross"               "cuddl"               "cum"                
 [211] "cup"                 "current"             "custcar"            
 [214] "custom"              "cut"                 "cute"               
 [217] "cuz"                 "dad"                 "daddi"              
 [220] "darl"                "darlin"              "darren"             
 [223] "dat"                 "date"                "day"                
 [226] "dead"                "deal"                "dear"               
 [229] "decid"               "decim"               "decis"              
 [232] "deep"                "definit"             "del"                
 [235] "deliv"               "deliveri"            "den"                
 [238] "depend"              "detail"              "didnt"              
 [241] "die"                 "diet"                "differ"             
 [244] "difficult"           "digit"               "din"                
 [247] "dinner"              "direct"              "dis"                
 [250] "discount"            "discuss"             "disturb"            
 [253] "dnt"                 "doc"                 "doctor"             
 [256] "doesnt"              "dog"                 "doin"               
 [259] "don"                 "done"                "dont"               
 [262] "door"                "doubl"               "download"           
 [265] "draw"                "dream"               "drink"              
 [268] "drive"               "drop"                "drug"               
 [271] "dude"                "due"                 "dun"                
 [274] "dunno"               "dvd"                 "earli"              
 [277] "earlier"             "earth"               "easi"               
 [280] "eat"                 "eatin"               "egg"                
 [283] "either"              "els"                 "email"              
 [286] "embarass"            "end"                 "energi"             
 [289] "england"             "enjoy"               "enough"             
 [292] "enter"               "entitl"              "entri"              
 [295] "envelop"             "etc"                 "euro"               
 [298] "eve"                 "even"                "ever"               
 [301] "everi"               "everybodi"           "everyon"            
 [304] "everyth"             "exact"               "exam"               
 [307] "excel"               "excit"               "excus"              
 [310] "expect"              "experi"              "expir"              
 [313] "extra"               "eye"                 "face"               
 [316] "facebook"            "fact"                "fall"               
 [319] "famili"              "fanci"               "fantasi"            
 [322] "fantast"             "far"                 "fast"               
 [325] "fat"                 "father"              "fault"              
 [328] "feb"                 "feel"                "felt"               
 [331] "fetch"               "fight"               "figur"              
 [334] "file"                "fill"                "film"               
 [337] "final"               "find"                "fine"               
 [340] "finger"              "finish"              "first"              
 [343] "fix"                 "flag"                "flat"               
 [346] "flight"              "flower"              "follow"             
 [349] "fone"                "food"                "forev"              
 [352] "forget"              "forgot"              "forward"            
 [355] "found"               "freak"               "free"               
 [358] "freemsg"             "freephon"            "fren"               
 [361] "fri"                 "friday"              "friend"             
 [364] "friendship"          "frm"                 "frnd"               
 [367] "frnds"               "full"                "fullonsmscom"       
 [370] "fun"                 "funni"               "futur"              
 [373] "gal"                 "game"                "gap"                
 [376] "gas"                 "gave"                "gay"                
 [379] "gentl"               "get"                 "gettin"             
 [382] "gift"                "girl"                "girlfrnd"           
 [385] "give"                "glad"                "god"                
 [388] "goe"                 "goin"                "gone"               
 [391] "gonna"               "good"                "goodmorn"           
 [394] "goodnight"           "got"                 "goto"               
 [397] "gotta"               "great"               "grin"               
 [400] "guarante"            "gud"                 "guess"              
 [403] "guy"                 "gym"                 "haf"                
 [406] "haha"                "hai"                 "hair"               
 [409] "half"                "hand"                "handset"            
 [412] "hang"                "happen"              "happi"              
 [415] "hard"                "hate"                "hav"                
 [418] "havent"              "head"                "hear"               
 [421] "heard"               "heart"               "heavi"              
 [424] "hee"                 "hell"                "hello"              
 [427] "help"                "hey"                 "hgsuiteland"        
 [430] "hit"                 "hiya"                "hmm"                
 [433] "hmmm"                "hmv"                 "hol"                
 [436] "hold"                "holder"              "holiday"            
 [439] "home"                "hook"                "hop"                
 [442] "hope"                "horni"               "hospit"             
 [445] "hot"                 "hotel"               "hour"               
 [448] "hous"                "how"                 "howev"              
 [451] "howz"                "hrs"                 "httpwwwurawinnercom"
 [454] "hug"                 "huh"                 "hungri"             
 [457] "hurri"               "hurt"                "ice"                
 [460] "idea"                "identifi"            "ignor"              
 [463] "ill"                 "immedi"              "import"             
 [466] "inc"                 "includ"              "india"              
 [469] "info"                "inform"              "insid"              
 [472] "instead"             "interest"            "invit"              
 [475] "ipod"                "irrit"               "ish"                
 [478] "island"              "issu"                "ive"                
 [481] "izzit"               "januari"             "jay"                
 [484] "job"                 "john"                "join"               
 [487] "joke"                "joy"                 "jst"                
 [490] "jus"                 "just"                "juz"                
 [493] "kate"                "keep"                "kept"               
 [496] "kick"                "kid"                 "kill"               
 [499] "kind"                "kinda"               "king"               
 [502] "kiss"                "knew"                "know"               
 [505] "knw"                 "ladi"                "land"               
 [508] "landlin"             "laptop"              "lar"                
 [511] "last"                "late"                "later"              
 [514] "latest"              "laugh"               "lazi"               
 [517] "ldn"                 "lead"                "learn"              
 [520] "least"               "leav"                "lect"               
 [523] "left"                "leh"                 "lei"                
 [526] "less"                "lesson"              "let"                
 [529] "letter"              "liao"                "librari"            
 [532] "lie"                 "life"                "lift"               
 [535] "light"               "like"                "line"               
 [538] "link"                "list"                "listen"             
 [541] "littl"               "live"                "lmao"               
 [544] "load"                "loan"                "local"              
 [547] "locat"               "log"                 "lol"                
 [550] "london"              "long"                "longer"             
 [553] "look"                "lookin"              "lor"                
 [556] "lose"                "lost"                "lot"                
 [559] "lovabl"              "love"                "lover"              
 [562] "loyalti"             "ltd"                 "luck"               
 [565] "lucki"               "lunch"               "luv"                
 [568] "mad"                 "made"                "mah"                
 [571] "mail"                "make"                "malaria"            
 [574] "man"                 "mani"                "march"              
 [577] "mark"                "marri"               "match"              
 [580] "mate"                "matter"              "maxim"              
 [583] "maxmin"              "may"                 "mayb"               
 [586] "meal"                "mean"                "meant"              
 [589] "med"                 "medic"               "meet"               
 [592] "meetin"              "meh"                 "member"             
 [595] "men"                 "merri"               "messag"             
 [598] "met"                 "mid"                 "midnight"           
 [601] "might"               "min"                 "mind"               
 [604] "mine"                "minut"               "miracl"             
 [607] "miss"                "mistak"              "moan"               
 [610] "mob"                 "mobil"               "mobileupd"          
 [613] "mode"                "mom"                 "moment"             
 [616] "mon"                 "monday"              "money"              
 [619] "month"               "morn"                "mother"             
 [622] "motorola"            "move"                "movi"               
 [625] "mrng"                "mrt"                 "mrw"                
 [628] "msg"                 "msgs"                "mths"               
 [631] "much"                "mum"                 "murder"             
 [634] "music"               "must"                "muz"                
 [637] "nah"                 "nake"                "name"               
 [640] "nation"              "natur"               "naughti"            
 [643] "near"                "need"                "net"                
 [646] "network"             "neva"                "never"              
 [649] "new"                 "news"                "next"               
 [652] "nice"                "nigeria"             "night"              
 [655] "nite"                "nobodi"              "noe"                
 [658] "nokia"               "noon"                "nope"               
 [661] "normal"              "normpton"            "noth"               
 [664] "notic"               "now"                 "num"                
 [667] "number"              "nyt"                 "obvious"            
 [670] "offer"               "offic"               "offici"             
 [673] "okay"                "oki"                 "old"                
 [676] "omg"                 "one"                 "onlin"              
 [679] "onto"                "oop"                 "open"               
 [682] "oper"                "opinion"             "opt"                
 [685] "optout"              "orang"               "orchard"            
 [688] "order"               "oredi"               "oso"                
 [691] "other"               "otherwis"            "outsid"             
 [694] "pack"                "page"                "paid"               
 [697] "pain"                "paper"               "parent"             
 [700] "park"                "part"                "parti"              
 [703] "partner"             "pass"                "passion"            
 [706] "password"            "past"                "pay"                
 [709] "peopl"               "per"                 "person"             
 [712] "pete"                "phone"               "photo"              
 [715] "pic"                 "pick"                "pictur"             
 [718] "pin"                 "piss"                "pix"                
 [721] "pizza"               "place"               "plan"               
 [724] "play"                "player"              "pleas"              
 [727] "pleasur"             "plenti"              "pls"                
 [730] "plus"                "plz"                 "pmin"               
 [733] "pmsg"                "pobox"               "point"              
 [736] "poli"                "polic"               "poor"               
 [739] "pop"                 "possess"             "possibl"            
 [742] "post"                "pound"               "power"              
 [745] "ppm"                 "pray"                "present"            
 [748] "press"               "pretti"              "previous"           
 [751] "price"               "princess"            "privat"             
 [754] "prize"               "prob"                "probabl"            
 [757] "problem"             "project"             "promis"             
 [760] "pub"                 "put"                 "qualiti"            
 [763] "question"            "quick"               "quit"               
 [766] "quiz"                "quot"                "rain"               
 [769] "random"              "rang"                "rate"               
 [772] "rather"              "rcvd"                "reach"              
 [775] "read"                "readi"               "real"               
 [778] "reali"               "realli"              "reason"             
 [781] "receipt"             "receiv"              "recent"             
 [784] "record"              "refer"               "regard"             
 [787] "regist"              "relat"               "relax"              
 [790] "remain"              "rememb"              "remind"             
 [793] "remov"               "rent"                "rental"             
 [796] "repli"               "repres"              "request"            
 [799] "respond"             "respons"             "rest"               
 [802] "result"              "return"              "reveal"             
 [805] "review"              "reward"              "right"              
 [808] "ring"                "rington"             "rite"               
 [811] "road"                "rock"                "role"               
 [814] "room"                "roommat"             "rose"               
 [817] "round"               "rowwjhl"             "rpli"               
 [820] "rreveal"             "run"                 "rush"               
 [823] "sad"                 "sae"                 "safe"               
 [826] "said"                "sale"                "sat"                
 [829] "saturday"            "savamob"             "save"               
 [832] "saw"                 "say"                 "sch"                
 [835] "school"              "scream"              "sea"                
 [838] "search"              "sec"                 "second"             
 [841] "secret"              "see"                 "seem"               
 [844] "seen"                "select"              "self"               
 [847] "sell"                "semest"              "send"               
 [850] "sens"                "sent"                "serious"            
 [853] "servic"              "set"                 "settl"              
 [856] "sex"                 "sexi"                "shall"              
 [859] "share"               "shd"                 "ship"               
 [862] "shirt"               "shop"                "short"              
 [865] "show"                "shower"              "sick"               
 [868] "side"                "sigh"                "sight"              
 [871] "sign"                "silent"              "simpl"              
 [874] "sinc"                "singl"               "sipix"              
 [877] "sir"                 "sis"                 "sister"             
 [880] "sit"                 "situat"              "skxh"               
 [883] "skype"               "slave"               "sleep"              
 [886] "slept"               "slow"                "slowli"             
 [889] "small"               "smile"               "smoke"              
 [892] "sms"                 "smth"                "snow"               
 [895] "sofa"                "sol"                 "somebodi"           
 [898] "someon"              "someth"              "sometim"            
 [901] "somewher"            "song"                "soni"               
 [904] "sonyericsson"        "soon"                "sorri"              
 [907] "sort"                "sound"               "south"              
 [910] "space"               "speak"               "special"            
 [913] "specialcal"          "spend"               "spent"              
 [916] "spoke"               "spree"               "stand"              
 [919] "start"               "statement"           "station"            
 [922] "stay"                "std"                 "step"               
 [925] "still"               "stockport"           "stone"              
 [928] "stop"                "store"               "stori"              
 [931] "street"              "student"             "studi"              
 [934] "stuff"               "stupid"              "style"              
 [937] "sub"                 "subscrib"            "success"            
 [940] "suck"                "suit"                "summer"             
 [943] "sun"                 "sunday"              "sunshin"            
 [946] "sup"                 "support"             "suppos"             
 [949] "sure"                "surf"                "surpris"            
 [952] "sweet"               "swing"               "system"             
 [955] "take"                "talk"                "tampa"              
 [958] "tariff"              "tcs"                 "tea"                
 [961] "teach"               "tear"                "teas"               
 [964] "tel"                 "tell"                "ten"                
 [967] "tenerif"             "term"                "test"               
 [970] "text"                "thank"               "thanx"              
 [973] "that"                "thing"               "think"              
 [976] "thinkin"             "thk"                 "tho"                
 [979] "though"              "thought"             "throw"              
 [982] "thru"                "tht"                 "thur"               
 [985] "tick"                "ticket"              "til"                
 [988] "till"                "time"                "tire"               
 [991] "titl"                "tmr"                 "toclaim"            
 [994] "today"               "togeth"              "told"               
 [997] "tomo"                "tomorrow"            "tone"               
[1000] "tonight"            
 [ reached getOption("max.print") -- omitted 137 entries ]
> sms_freq_words <- findFreqTerms(sms_dtm_train, 5)
> str(sms_freq_words)
 chr [1:1137] "£wk" "abiola" "abl" "abt" "accept" "access" "account" "across" "act" ...
> 
> sms_dtm_freq_train <- sms_dtm_train[ , sms_freq_words]
> sms_dtm_freq_test <- sms_dtm_test[ , sms_freq_words]
> 
> # convert counts to a factor
> convert_counts <- function(x) {
+     x <- ifelse(x > 0, "Yes", "No")
+ }
> sms_train <- apply(sms_dtm_freq_train, MARGIN = 2, convert_counts)
> sms_test  <- apply(sms_dtm_freq_test, MARGIN = 2, convert_counts)
> 
> library(e1071)
Error in library(e1071) : there is no package called ‘e1071’
> install.packages('e1071')
Installing package into ‘/cloud/lib/x86_64-pc-linux-gnu-library/4.2’
(as ‘lib’ is unspecified)
also installing the dependency ‘proxy’

trying URL 'http://rspm/default/__linux__/focal/latest/src/contrib/proxy_0.4-27.tar.gz'
Content type 'application/x-gzip' length 210204 bytes (205 KB)
==================================================
downloaded 205 KB

trying URL 'http://rspm/default/__linux__/focal/latest/src/contrib/e1071_1.7-13.tar.gz'
Content type 'application/x-gzip' length 572894 bytes (559 KB)
==================================================
downloaded 559 KB

* installing *binary* package ‘proxy’ ...
* DONE (proxy)
* installing *binary* package ‘e1071’ ...
* DONE (e1071)

The downloaded source packages are in
	‘/tmp/RtmpkFYIbE/downloaded_packages’
> library(e1071)
> sms_classifier <- naiveBayes(sms_train, sms_train_labels)
> sms_test_pred <- predict(sms_classifier, sms_test)
> library(gmodels)
Error in library(gmodels) : there is no package called ‘gmodels’
> install.packages('gmodels')
Installing package into ‘/cloud/lib/x86_64-pc-linux-gnu-library/4.2’
(as ‘lib’ is unspecified)
also installing the dependencies ‘gtools’, ‘gdata’

trying URL 'http://rspm/default/__linux__/focal/latest/src/contrib/gtools_3.9.4.tar.gz'
Content type 'application/x-gzip' length 353462 bytes (345 KB)
==================================================
downloaded 345 KB

trying URL 'http://rspm/default/__linux__/focal/latest/src/contrib/gdata_2.18.0.1.tar.gz'
Content type 'application/x-gzip' length 1215103 bytes (1.2 MB)
==================================================
downloaded 1.2 MB

trying URL 'http://rspm/default/__linux__/focal/latest/src/contrib/gmodels_2.18.1.1.tar.gz'
Content type 'application/x-gzip' length 112443 bytes (109 KB)
==================================================
downloaded 109 KB

* installing *binary* package ‘gtools’ ...
* DONE (gtools)
* installing *binary* package ‘gdata’ ...
* DONE (gdata)
* installing *binary* package ‘gmodels’ ...
* DONE (gmodels)

The downloaded source packages are in
	‘/tmp/RtmpkFYIbE/downloaded_packages’
> library(gmodels)
> CrossTable(sms_test_pred, sms_test_labels,
+            prop.chisq = FALSE, prop.c = FALSE, prop.r = FALSE,
+            dnn = c('predicted', 'actual'))

 
   Cell Contents
|-------------------------|
|                       N |
|         N / Table Total |
|-------------------------|

 
Total Observations in Table:  1390 

 
             | actual 
   predicted |       ham |      spam | Row Total | 
-------------|-----------|-----------|-----------|
         ham |      1201 |        30 |      1231 | 
             |     0.864 |     0.022 |           | 
-------------|-----------|-----------|-----------|
        spam |         6 |       153 |       159 | 
             |     0.004 |     0.110 |           | 
-------------|-----------|-----------|-----------|
Column Total |      1207 |       183 |      1390 | 
-------------|-----------|-----------|-----------|

 
> sms_classifier2 <- naiveBayes(sms_train, sms_train_labels, laplace = 1)
> sms_test_pred2 <- predict(sms_classifier2, sms_test)
> CrossTable(sms_test_pred2, sms_test_labels,
+            prop.chisq = FALSE, prop.c = FALSE, prop.r = FALSE,
+            dnn = c('predicted', 'actual'))

 
   Cell Contents
|-------------------------|
|                       N |
|         N / Table Total |
|-------------------------|

 
Total Observations in Table:  1390 

 
             | actual 
   predicted |       ham |      spam | Row Total | 
-------------|-----------|-----------|-----------|
         ham |      1189 |        16 |      1205 | 
             |     0.855 |     0.012 |           | 
-------------|-----------|-----------|-----------|
        spam |        18 |       167 |       185 | 
             |     0.013 |     0.120 |           | 
-------------|-----------|-----------|-----------|
Column Total |      1207 |       183 |      1390 | 
-------------|-----------|-----------|-----------|

 
